{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "> Enrich Assets via CMDB",
    "aliasName": null,
    "tag": null,
    "description": "for future use",
    "isActive": false,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1648039709,
    "collection": "\/api\/3\/workflow_collections\/c1ca92eb-8ec4-4dba-9a3d-156bf0a1abc2",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/955ee7e0-8952-43ed-b77d-b196650dc5c9",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Update Asset",
            "description": null,
            "arguments": {
                "when": "{{vars.device_details}}",
                "resource": {
                    "name": "{{vars.device_details.device.name}}",
                    "state": {
                        "id": 176,
                        "@id": "\/api\/3\/picklists\/b31da3b9-6f87-469e-a1bf-2517c48a7001",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Active",
                        "listName": "\/api\/3\/picklist_names\/45de7d2e-8ef0-495e-a6e5-07fddfbd4749",
                        "itemValue": "Active",
                        "orderIndex": 1
                    },
                    "__link": {
                        "recordTags": [
                            "\/api\/3\/tags\/SIMMLM"
                        ]
                    },
                    "status": {
                        "id": 59,
                        "@id": "\/api\/3\/picklists\/421c20cd-e63d-4e32-9a25-774b2155cd24",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Active",
                        "listName": "\/api\/3\/picklist_names\/3c57ea34-4866-4c8f-ba74-dc51806727a9",
                        "itemValue": "Active",
                        "orderIndex": 0
                    },
                    "emailId": "{{vars.device_details.device.contact}}",
                    "category": {
                        "id": 192,
                        "@id": "\/api\/3\/picklists\/bb8b4a11-98ab-458e-9db2-d4a3cda8b874",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Desktop",
                        "listName": "\/api\/3\/picklist_names\/0042bf40-d0e6-4324-ab84-0c7b0703f681",
                        "itemValue": "Desktop",
                        "orderIndex": 2
                    },
                    "hostname": "{{vars.device_details.device.name}}",
                    "managedBy": "{{vars.device_details.device.contact}}",
                    "macAddress": "{{vars.device_details.device.interfaces.networkinterface.macAddr}}",
                    "propertyOf": "{{vars.device_details.device.department}}",
                    "criticality": {
                        "id": 237,
                        "@id": "\/api\/3\/picklists\/f734dfbb-fd61-425e-8a14-ebd560289fac",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#DE7A13",
                        "display": "High",
                        "listName": "\/api\/3\/picklist_names\/f8d09b4a-9e91-4096-bbdd-06a9f96ef57e",
                        "itemValue": "High",
                        "orderIndex": 3
                    },
                    "description": "{{vars.device_details.device.description}}",
                    "serialNumber": "{{vars.device_details.device.interfaces.networkinterface.macAddr.replace(\":\",\"\")}}",
                    "operatingSystem": "{%if \"Linux\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Linux\", \"@id\")}}{%elif \"UNIX\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"UNIX\",\"@id\")}}{%elif \"Windows 7\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Windows 7\",\"@id\")}}{%elif \"Windows 8\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Windows 8\",\"@id\")}}{%elif \"Windows 10\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Windows 10\",\"@id\")}}{%elif \"OS X\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"OS X\",\"@id\")}}{%elif \"iOS\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"iOS\",\"@id\")}}{%elif \"Android\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Android\",\"@id\")}}{%elif \"Windows Phone\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Windows Phone\",\"@id\")}}{%elif \"Other\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Other\",\"@id\")}}{%elif \"Server 2003\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Server 2003\",\"@id\")}}{%elif \"Server 2008\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Server 2008\",\"@id\")}}{%elif \"Server 2012\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Server 2012\",\"@id\")}}{%elif \"Server 2016\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Server 2016\",\"@id\")}}{%elif \"Server 2019\" in vars.device_details.device.deviceType.model%}{{\"OperatingSystem\" | picklist(\"Server 2019\",\"@id\")}}{%endif%}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/assets",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": {
                    "is_critical": "{%if vars.device_details.device.department == 'Engineering'%}True{%else%}False{%endif%}"
                }
            },
            "status": null,
            "top": "570",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "36201344-6245-433c-8e7c-605f1126c46b",
            "id": 15588
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Device Details",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "8ea08a0e-458a-4d6f-be15-1dbe8feeef99",
                "params": {
                    "ip": "{{vars.input.records[0].ip}}",
                    "org": "FortiSOAR"
                },
                "version": "4.3.1",
                "connector": "fortinet-fortisiem",
                "operation": "get_device_info",
                "mock_result": "{{vars.mockout_data}}",
                "operationTitle": "Get Device Information",
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "8563ad7d-b6ce-44c3-9359-7957f9575a69",
            "id": 15591
        },
        {
            "@type": "WorkflowStep",
            "name": "Process Device Details",
            "description": null,
            "arguments": {
                "device_details": "{%if vars.steps.Get_Device_Details.data%}{{vars.steps.Get_Device_Details.data}}{%endif%}",
                "related_alerts": "{{((vars.input.records[0]['@id']+ \"?$relationships=true\")|fromIRI).alerts}}"
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "8ccad572-233f-4e88-beba-bc8579689a31",
            "id": 15589
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "assets",
                "resources": [
                    "assets"
                ],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    },
                    "useMockOutput": "{{globalVars.Demo_mode}}"
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                }
            },
            "status": null,
            "top": "20",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "uuid": "955ee7e0-8952-43ed-b77d-b196650dc5c9",
            "id": 15587
        },
        {
            "@type": "WorkflowStep",
            "name": "Init Input Data",
            "description": null,
            "arguments": {
                "mockout_data": "{\n    \"data\": {\n      \"device\": {\n        \"luns\": null,\n        \"name\": \"ExchangeServer\",\n        \"contact\": \"asmith@fortielab.com\",\n        \"version\": \"ANY\",\n        \"accessIp\": \"{{vars.input.records[0].ip}}\",\n        \"approved\": \"false\",\n        \"location\": null,\n        \"storages\": null,\n        \"unmanaged\": \"false\",\n        \"annotation\": null,\n        \"components\": null,\n        \"department\": \"IT\",\n        \"deviceType\": {\n          \"model\": \"Microsoft Windows Server 2019 Standard Evaluation 10.0.17763\",\n          \"vendor\": \"OSVendor\",\n          \"version\": \"ANY\",\n          \"jobWeight\": \"10\",\n          \"accessProtocols\": \"LDAP,LDAPS,LDAP_TLS,TELNET,SSH\"\n        },\n        \"interfaces\": {\n          \"networkinterface\": {\n            \"name\": \"Interface0\",\n            \"type\": \"Ethernet\",\n            \"isWAN\": \"false\",\n            \"isTrunk\": \"true\",\n            \"macAddr\": \"01:00:00:ae:2f:{{range(11,99)|random }}\",\n            \"ipv4Addr\": \"{{vars.input.records[0].ip}}\",\n            \"ipv4Mask\": \"24\",\n            \"ipv6Addr\": null,\n            \"isMonitor\": \"false\",\n            \"ipv6Prefix\": null,\n            \"isCritical\": \"false\",\n            \"operStatus\": \"up\",\n            \"macIsVirtual\": \"false\",\n            \"updateMethod\": \"MANUAL\",\n            \"ipv4IsVirtual\": \"false\"\n          }\n        },\n        \"processors\": null,\n        \"raidGroups\": null,\n        \"description\": \"Workstation\",\n        \"applications\": null,\n        \"organization\": {\n          \"@id\": \"1\",\n          \"@name\": \"Super\"\n        },\n        \"updateMethod\": \"MANUAL\",\n        \"ipToHostNames\": null,\n        \"storageGroups\": null,\n        \"creationMethod\": \"MANUAL\",\n        \"eventParserList\": null,\n        \"softwarePatches\": null,\n        \"softwareServices\": null,\n        \"primaryContactUser\": \"0\",\n        \"sanControllerPorts\": null,\n        \"secondaryContactUser\": \"0\"\n      }\n    },\n    \"status\": \"Success\",\n    \"_status\": true,\n    \"message\": \"\",\n    \"operation\": null,\n    \"request_id\": null\n  }"
            },
            "status": null,
            "top": "160",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "ba7abce9-4d12-47ff-98ba-855a7f38d2e5",
            "id": 15590
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Process Device Details -> Update Asset",
            "targetStep": "\/api\/3\/workflow_steps\/36201344-6245-433c-8e7c-605f1126c46b",
            "sourceStep": "\/api\/3\/workflow_steps\/8ccad572-233f-4e88-beba-bc8579689a31",
            "label": null,
            "isExecuted": false,
            "uuid": "6172ce0e-6125-42d6-9761-18349fe429ad"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Mockout Data -> Get Device Details",
            "targetStep": "\/api\/3\/workflow_steps\/8563ad7d-b6ce-44c3-9359-7957f9575a69",
            "sourceStep": "\/api\/3\/workflow_steps\/ba7abce9-4d12-47ff-98ba-855a7f38d2e5",
            "label": null,
            "isExecuted": false,
            "uuid": "d1831b70-fdd0-4ca3-9108-2bbb2982e60d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Set Mockout Data",
            "targetStep": "\/api\/3\/workflow_steps\/ba7abce9-4d12-47ff-98ba-855a7f38d2e5",
            "sourceStep": "\/api\/3\/workflow_steps\/955ee7e0-8952-43ed-b77d-b196650dc5c9",
            "label": null,
            "isExecuted": false,
            "uuid": "278220a5-d6ca-4b71-be81-2397e9bb5012"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Device Details -> Process Device Details",
            "targetStep": "\/api\/3\/workflow_steps\/8ccad572-233f-4e88-beba-bc8579689a31",
            "sourceStep": "\/api\/3\/workflow_steps\/8563ad7d-b6ce-44c3-9359-7957f9575a69",
            "label": null,
            "isExecuted": false,
            "uuid": "05e39d07-acf4-4243-a2f5-edb573f93f4c"
        }
    ],
    "priority": null,
    "uuid": "018b3c37-68f2-4808-b76b-bfe3455f3448",
    "recordTags": [
        "Enrichment"
    ],
    "id": 2933,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1648032858,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1648039712,
    "owners": [],
    "isPrivate": false
}